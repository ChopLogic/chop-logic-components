import{j as o,r as c}from"./iframe-DP4TfwvB.js";import{L as D}from"./Label-GsN7KfjG.js";import{u as O}from"./use-click-outside-yBZhbwYK.js";import{u as R}from"./use-element-ids-BwRwfIW9.js";import{u as E}from"./use-key-press-Qz_3YznQ.js";import{g as _}from"./get-class-name-BY88G7uf.js";import{h as F}from"./Option-CTSW_nAD.js";import{I as x,E as q}from"./Icon-DgdWz_xl.js";import{I}from"./icon-name-DofyCo9k.js";import{F as K,u as A}from"./use-reset-form-input-CGOMNfpm.js";const C=({values:e,placeholder:t})=>{const l=e?e.filter(a=>a.selected).map(a=>a.label):[],n=l.length!==0&&l.length===e?.length,r=l.length===1,s=l.length>1;return n?o.jsx("span",{children:"All items selected"}):r?o.jsx("span",{children:l[0]}):s?o.jsx("span",{children:`${l.length} items selected`}):o.jsx("span",{children:t})};try{C.displayName="MultiSelectComboboxSelectedValues",C.__docgenInfo={description:"",displayName:"MultiSelectComboboxSelectedValues",props:{values:{defaultValue:null,description:"",name:"values",required:!1,type:{name:"MultiSelectValue[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}}}}}catch{}const M=({opened:e,onClick:t,comboboxId:l,dropdownId:n,name:r,placeholder:s,disabled:a,required:i,values:d})=>{const p=d?.filter(u=>u.selected).map(u=>u.id),m=_(["cl-select-combobox__icon",{"cl-select-combobox__icon_opened":e}]);return o.jsxs("button",{type:"button",name:r,value:p,role:"combobox","aria-haspopup":"listbox","aria-expanded":e,"aria-controls":n,id:l,onClick:t,disabled:a,"aria-required":i,className:"cl-select-combobox",children:[o.jsx(C,{values:d,placeholder:s}),o.jsx(x,{name:I.ChevronDown,className:m,size:q.Small})]})};try{M.displayName="MultiSelectCombobox",M.__docgenInfo={description:"",displayName:"MultiSelectCombobox",props:{opened:{defaultValue:null,description:"",name:"opened",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},comboboxId:{defaultValue:null,description:"",name:"comboboxId",required:!0,type:{name:"string"}},dropdownId:{defaultValue:null,description:"",name:"dropdownId",required:!0,type:{name:"string"}},values:{defaultValue:null,description:"",name:"values",required:!1,type:{name:"MultiSelectValue[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}}}}}catch{}function z({name:e,options:t,initialValues:l,defaultValue:n}){return t.map(r=>{let s=!1;return l?.[e]&&Array.isArray(l[e])&&l[e].find(i=>i===r.id||i?.id===r.id)&&(s=!0),!l?.[e]&&Array.isArray(n)&&n.find(i=>i===r.id)&&(s=!0),{...r,selected:s}})}const j=e=>e.filter(t=>t.selected).map(t=>t.id),L=(e,t)=>{const l=e.find(n=>n.id===t);return e.map(n=>n.id===t?{...n,selected:!l?.selected}:n)};function P({name:e,defaultValue:t,onChange:l,options:n}){const[r,s]=c.useState(!1),{onChangeFormInput:a,initialValues:i}=c.useContext(K),d=z({name:e,options:n,initialValues:i,defaultValue:t}),[p,m]=c.useState(d),u=c.useRef(a),f=c.useRef(d);u.current=a,f.current=d;const S=()=>s(!1),b=()=>s(!r),V=g=>{const y=L(p,g);m(y),l?.(y),a?.({name:e,value:j(y)})},h=c.useCallback(()=>{s(!1),m(f.current),u.current?.({name:e,value:j(f.current)})},[e]);return A(h),{handleClose:S,handleToggle:b,handleSelect:V,opened:r,values:p}}const v=({value:e,onSelect:t})=>{const{id:l,label:n,selected:r}=e,s=_(["cl-select-option","cl-select-option_multi",{"cl-select-option_selected":r}]),a=i=>d=>{switch(d.key){case" ":case"SpaceBar":case"Enter":d.preventDefault(),t(i);break}};return o.jsxs("li",{id:l,role:"option","aria-selected":r,tabIndex:0,onKeyDown:a(l),onClick:()=>t(l),className:s,children:[r?o.jsx(x,{name:I.CheckSquare,size:q.Small}):o.jsx(x,{name:I.Square,size:q.Small}),o.jsx("span",{children:n})]})};try{v.displayName="MultiSelectOption",v.__docgenInfo={description:"",displayName:"MultiSelectOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"MultiSelectValue"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(id: string) => void"}}}}}catch{}const N=({options:e,opened:t,onClose:l,onSelect:n,dropdownId:r})=>{const s=_(["cl-select-dropdown",{"cl-select-dropdown_opened":t}]);return o.jsx("ul",{role:"listbox",id:r,tabIndex:-1,onKeyDown:a=>F({e:a,options:e,onClose:l}),className:s,children:e.map(a=>o.jsx(v,{value:a,onSelect:()=>n(a.id)},a.id))})};try{N.displayName="MultiSelectDropdown",N.__docgenInfo={description:"",displayName:"MultiSelectDropdown",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"MultiSelectValue[]"}},opened:{defaultValue:null,description:"",name:"opened",required:!0,type:{name:"boolean"}},dropdownId:{defaultValue:null,description:"",name:"dropdownId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(id: string) => void"}}}}}catch{}const w=({options:e,name:t,label:l,required:n=!1,placeholder:r="Not selected",disabled:s=!1,onChange:a,defaultValue:i,id:d,className:p,...m})=>{const u=c.useRef(null),{elementId:f,dropdownId:S}=R(d),{handleClose:b,handleSelect:V,handleToggle:h,opened:g,values:y}=P({name:t,options:e,defaultValue:i,onChange:a}),k=_(["cl-select",p]);return O({ref:u,onClickOutsideHandler:b}),E({keyCode:"Escape",ref:u,onKeyPress:b}),o.jsxs("div",{ref:u,...m,className:k,children:[o.jsx(D,{label:l,required:n,inputId:f,disabled:s}),o.jsx(M,{name:t,opened:g,comboboxId:f,dropdownId:S,onClick:h,values:y,placeholder:r,disabled:s,required:n}),o.jsx(N,{options:y,opened:g,onClose:b,dropdownId:S,onSelect:V})]})};try{w.displayName="MultiSelect",w.__docgenInfo={description:"",displayName:"MultiSelect",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectValue[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((values?: SelectValue[]) => void)"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string | number | readonly string[]"}},placeholder:{defaultValue:{value:"Not selected"},description:"",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},required:{defaultValue:{value:"false"},description:"",name:"required",required:!1,type:{name:"boolean"}},stateless:{defaultValue:null,description:"",name:"stateless",required:!1,type:{name:"boolean"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string | number | readonly string[]"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},tabIndex:{defaultValue:null,description:"",name:"tabIndex",required:!1,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}}}catch{}export{w as M};
