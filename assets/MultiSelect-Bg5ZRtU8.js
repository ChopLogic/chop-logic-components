var P=Object.defineProperty,$=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var D=(e,l,t)=>l in e?P(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,g=(e,l)=>{for(var t in l||(l={}))A.call(l,t)&&D(e,t,l[t]);if(q)for(var t of q(l))O.call(l,t)&&D(e,t,l[t]);return e},V=(e,l)=>$(e,U(l));var v=(e,l)=>{var t={};for(var n in e)A.call(e,n)&&l.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&q)for(var n of q(e))l.indexOf(n)<0&&O.call(e,n)&&(t[n]=e[n]);return t};import{j as o,r as m}from"./iframe-BtTQsrQT.js";import{L as F}from"./Label-DX3cIGOQ.js";import{u as T}from"./use-click-outside-ajOA-CeE.js";import{u as B}from"./use-element-ids-B0aiT4og.js";import{u as H}from"./use-key-press-Cy56pnAc.js";import{g as j}from"./get-class-name-BY88G7uf.js";import{s as z,a as I,b as K,h as G,c as J}from"./Option.module-BDqhWEs6.js";import{A as Q,b as W,C as X,c as Y}from"./Icon-Z7qWIs8D.js";import{F as Z,u as ee}from"./use-reset-form-input-B2zVg9GE.js";const C=({opened:e,onClick:l,comboboxId:t,dropdownId:n,name:s,placeholder:d,disabled:r,required:i,values:a})=>{const c=a==null?void 0:a.filter(u=>u.selected).map(u=>u.label),f=a==null?void 0:a.filter(u=>u.selected).map(u=>u.id);let p=o.jsx("span",{children:d});return c&&c.length===(a==null?void 0:a.length)?p=o.jsx("span",{children:"All items selected"}):c&&c.length===1?p=o.jsx("span",{children:c[0]}):c&&c.length>1&&(p=o.jsx("span",{children:`${c.length} items selected`})),o.jsxs("button",{type:"button",name:s,value:f,role:"combobox","aria-haspopup":"listbox","aria-expanded":e,"aria-controls":n,id:t,onClick:l,disabled:r,"aria-required":i,className:z.combobox,children:[p,e?o.jsx(Q,{}):o.jsx(W,{})]})};try{C.displayName="MultiSelectCombobox",C.__docgenInfo={description:"",displayName:"MultiSelectCombobox",props:{opened:{defaultValue:null,description:"",name:"opened",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},comboboxId:{defaultValue:null,description:"",name:"comboboxId",required:!0,type:{name:"string"}},dropdownId:{defaultValue:null,description:"",name:"dropdownId",required:!0,type:{name:"string"}},values:{defaultValue:null,description:"",name:"values",required:!1,type:{name:"MultiSelectValue[]"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}}}}}catch(e){}function te({name:e,options:l,initialValues:t,defaultValue:n}){return l.map(s=>{let d=!1;return t!=null&&t[e]&&Array.isArray(t[e])&&t[e].find(i=>i===s.id||(i==null?void 0:i.id)===s.id)&&(d=!0),!(t!=null&&t[e])&&Array.isArray(n)&&n.find(i=>i===s.id)&&(d=!0),V(g({},s),{selected:d})})}const R=e=>e.filter(l=>l.selected).map(l=>l.id),le=(e,l)=>{const t=e.find(n=>n.id===l);return e.map(n=>n.id===l?V(g({},n),{selected:!(t!=null&&t.selected)}):n)};function ne({name:e,defaultValue:l,onChange:t,options:n}){const[s,d]=m.useState(!1),{onChangeFormInput:r,initialValues:i}=m.useContext(Z),a=te({name:e,options:n,initialValues:i,defaultValue:l}),[c,f]=m.useState(a),p=m.useRef(r),u=m.useRef(a);p.current=r,u.current=a;const b=()=>d(!1),h=()=>d(!s),S=y=>{const _=le(c,y);f(_),t==null||t(_),r==null||r({name:e,value:R(_)})},x=m.useCallback(()=>{var y;d(!1),f(u.current),(y=p.current)==null||y.call(p,{name:e,value:R(u.current)})},[e]);return ee(x),{handleClose:b,handleToggle:h,handleSelect:S,opened:s,values:c}}const w=({value:e,onSelect:l})=>{const{id:t,label:n,selected:s}=e,d=j([I.option,I.option__multi,{[I.option__selected]:s}]),r=i=>a=>{switch(a.key){case" ":case"SpaceBar":case"Enter":a.preventDefault(),l(i);break}};return o.jsxs("li",{id:t,role:"option","aria-selected":s,tabIndex:0,onKeyDown:r(t),onClick:()=>l(t),className:d,children:[s?o.jsx(X,{}):o.jsx(Y,{}),o.jsx("span",{children:n})]})};try{w.displayName="MultiSelectOption",w.__docgenInfo={description:"",displayName:"MultiSelectOption",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"MultiSelectValue"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(id: string) => void"}}}}}catch(e){}const M=({options:e,opened:l,onClose:t,onSelect:n,dropdownId:s})=>{const d=j([K.dropdown,{[K.dropdown__opened]:l}]);return o.jsx("ul",{role:"listbox",id:s,tabIndex:-1,onKeyDown:r=>G({e:r,options:e,onClose:t}),className:d,children:e.map(r=>o.jsx(w,{value:r,onSelect:()=>n(r.id)},r.id))})};try{M.displayName="MultiSelectDropdown",M.__docgenInfo={description:"",displayName:"MultiSelectDropdown",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"MultiSelectValue[]"}},opened:{defaultValue:null,description:"",name:"opened",required:!0,type:{name:"boolean"}},dropdownId:{defaultValue:null,description:"",name:"dropdownId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onSelect:{defaultValue:null,description:"",name:"onSelect",required:!0,type:{name:"(id: string) => void"}}}}}catch(e){}const E=p=>{var u=p,{options:e,name:l,label:t,required:n=!1,placeholder:s="Not selected",disabled:d=!1,onChange:r,defaultValue:i,id:a,className:c}=u,f=v(u,["options","name","label","required","placeholder","disabled","onChange","defaultValue","id","className"]);const b=m.useRef(null),{elementId:h,dropdownId:S}=B(a),{handleClose:x,handleSelect:y,handleToggle:_,opened:N,values:k}=ne({name:l,options:e,defaultValue:i,onChange:r}),L=j([J.wrapper,c]);return T({ref:b,onClickOutsideHandler:x}),H({keyCode:"Escape",ref:b,onKeyPress:x}),o.jsxs("div",V(g({ref:b},f),{className:L,children:[o.jsx(F,{label:t,required:n,inputId:h}),o.jsx(C,{name:l,opened:N,comboboxId:h,dropdownId:S,onClick:_,values:k,placeholder:s,disabled:d,required:n}),o.jsx(M,{options:k,opened:N,onClose:x,dropdownId:S,onSelect:y})]}))};try{E.displayName="MultiSelect",E.__docgenInfo={description:"",displayName:"MultiSelect",props:{options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"SelectValue[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((values?: SelectValue[]) => void)"}},defaultValue:{defaultValue:null,description:"",name:"defaultValue",required:!1,type:{name:"string | number | readonly string[]"}},placeholder:{defaultValue:{value:"Not selected"},description:"",name:"placeholder",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},disabled:{defaultValue:{value:"false"},description:"",name:"disabled",required:!1,type:{name:"boolean"}},required:{defaultValue:{value:"false"},description:"",name:"required",required:!1,type:{name:"boolean"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},tabIndex:{defaultValue:null,description:"",name:"tabIndex",required:!1,type:{name:"number"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}}}}}catch(e){}export{E as M};
